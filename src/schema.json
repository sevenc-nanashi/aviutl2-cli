{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "aviutl2.config.schema.json",
  "type": "object",
  "properties": {
    "project": {
      "$ref": "#/$defs/Project",
      "description": "プロジェクト設定"
    },
    "artifacts": {
      "$ref": "#/$defs/RecordArtifact",
      "description": "成果物の定義"
    },
    "build_group": {
      "type": "object",
      "properties": {},
      "description": "ビルドコマンドのグループ定義",
      "additionalProperties": {
        "anyOf": [
          {
            "type": "string"
          },
          {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          {
            "$ref": "#/$defs/BuildGroupRef"
          }
        ]
      }
    },
    "development": {
      "$ref": "#/$defs/Development",
      "description": "開発用の設定"
    },
    "preview": {
      "$ref": "#/$defs/Preview",
      "description": "プレビュー用の設定"
    },
    "release": {
      "$ref": "#/$defs/Release",
      "description": "リリース用の設定"
    },
    "catalog": {
      "$ref": "#/$defs/Catalog",
      "description": "AviUtl2 カタログの定義"
    }
  },
  "required": [
    "project",
    "artifacts"
  ],
  "$defs": {
    "Project": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "description": "プロジェクト名"
        },
        "version": {
          "type": "string",
          "description": "バージョン"
        }
      },
      "required": [
        "name",
        "version"
      ]
    },
    "RecordArtifact": {
      "type": "object",
      "properties": {},
      "additionalProperties": {
        "$ref": "#/$defs/Artifact"
      }
    },
    "BuildGroupRef": {
      "type": "object",
      "properties": {
        "group": {
          "type": "string",
          "description": "利用する build_group のキー"
        }
      },
      "required": [
        "group"
      ]
    },
    "Development": {
      "type": "object",
      "properties": {
        "aviutl2_version": {
          "type": "string",
          "description": "AviUtl2 のバージョン"
        },
        "install_dir": {
          "type": "string",
          "description": "AviUtl2 のインストール先"
        },
        "profile": {
          "type": "string",
          "description": "使うプロファイル名（デフォルトは debug）"
        },
        "prebuild": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            {
              "$ref": "#/$defs/BuildGroupRef"
            }
          ],
          "description": "事前ビルドコマンド"
        },
        "postbuild": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            {
              "$ref": "#/$defs/BuildGroupRef"
            }
          ],
          "description": "事後ビルドコマンド"
        }
      },
      "required": [
        "aviutl2_version"
      ]
    },
    "Preview": {
      "type": "object",
      "properties": {
        "aviutl2_version": {
          "type": "string",
          "description": "AviUtl2 のバージョン（省略時は development.aviutl2_version）"
        },
        "install_dir": {
          "type": "string",
          "description": "AviUtl2 のインストール先"
        },
        "profile": {
          "type": "string",
          "description": "使うプロファイル名（デフォルトは release）"
        },
        "include": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "含める成果物のリスト（省略時は release.include を使用）"
        },
        "prebuild": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            {
              "$ref": "#/$defs/BuildGroupRef"
            }
          ],
          "description": "事前ビルドコマンド"
        },
        "postbuild": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            {
              "$ref": "#/$defs/BuildGroupRef"
            }
          ],
          "description": "事後ビルドコマンド"
        }
      }
    },
    "Release": {
      "type": "object",
      "properties": {
        "output_dir": {
          "type": "string",
          "description": "出力ディレクトリ"
        },
        "package_template": {
          "type": "string",
          "description": "package.txt のテンプレート"
        },
        "zip_name": {
          "type": "string",
          "description": "zip の名前（`.au2pkg.zip` は自動付与）"
        },
        "profile": {
          "type": "string",
          "description": "使うプロファイル名（デフォルトは release）"
        },
        "include": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "含める成果物のリスト（省略時はすべて含める）"
        },
        "prebuild": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            {
              "$ref": "#/$defs/BuildGroupRef"
            }
          ],
          "description": "事前ビルドコマンド"
        },
        "postbuild": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            {
              "$ref": "#/$defs/BuildGroupRef"
            }
          ],
          "description": "事後ビルドコマンド"
        }
      }
    },
    "Catalog": {
      "type": "object",
      "properties": {
        "id": {
          "type": "string",
          "description": "ID"
        },
        "name": {
          "type": "string",
          "description": "パッケージ名"
        },
        "type": {
          "anyOf": [
            {
              "type": "string",
              "const": "output"
            },
            {
              "type": "string",
              "const": "input"
            },
            {
              "type": "string",
              "const": "filter"
            },
            {
              "type": "string",
              "const": "common"
            },
            {
              "type": "string",
              "const": "modification"
            },
            {
              "type": "string",
              "const": "script"
            },
            {
              "type": "string",
              "const": "language"
            }
          ],
          "description": "種類"
        },
        "author": {
          "type": "string",
          "description": "作者名"
        },
        "original_author": {
          "type": "string",
          "description": "オリジナル作者名"
        },
        "niconi_commons_id": {
          "type": "string",
          "description": "ニコニ・コモンズID"
        },
        "summary": {
          "type": "string",
          "description": "概要"
        },
        "homepage": {
          "type": "string",
          "description": "パッケージのサイト"
        },
        "dependencies": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "依存パッケージ（未使用）"
        },
        "tags": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "タグ"
        },
        "description": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "object",
              "properties": {
                "type": {
                  "type": "string",
                  "const": "url"
                },
                "url": {
                  "type": "string",
                  "description": "URL"
                }
              },
              "required": [
                "type",
                "url"
              ]
            },
            {
              "type": "object",
              "properties": {
                "type": {
                  "type": "string",
                  "const": "inline"
                },
                "content": {
                  "type": "string",
                  "description": "Markdown 形式の内容"
                }
              },
              "required": [
                "type",
                "content"
              ]
            }
          ],
          "description": "説明"
        },
        "license": {
          "anyOf": [
            {
              "$ref": "#/$defs/TemplateCatalogLicense"
            },
            {
              "$ref": "#/$defs/CustomCatalogLicense"
            },
            {
              "$ref": "#/$defs/CC0License"
            },
            {
              "$ref": "#/$defs/CustomCatalogLicense"
            },
            {
              "$ref": "#/$defs/UnknownCatalogLicense"
            }
          ],
          "description": "ライセンス情報"
        },
        "download_source": {
          "anyOf": [
            {
              "type": "object",
              "properties": {
                "type": {
                  "type": "string",
                  "const": "direct"
                },
                "url": {
                  "type": "string"
                }
              },
              "required": [
                "type",
                "url"
              ]
            },
            {
              "type": "object",
              "properties": {
                "type": {
                  "type": "string",
                  "const": "booth"
                },
                "url": {
                  "type": "string"
                }
              },
              "required": [
                "type",
                "url"
              ]
            },
            {
              "type": "object",
              "properties": {
                "type": {
                  "type": "string",
                  "const": "github"
                },
                "owner": {
                  "type": "string"
                },
                "repo": {
                  "type": "string"
                },
                "pattern": {
                  "type": "string"
                }
              },
              "required": [
                "type",
                "owner",
                "repo"
              ]
            },
            {
              "type": "object",
              "properties": {
                "type": {
                  "type": "string",
                  "const": "google_drive"
                },
                "id": {
                  "type": "string"
                }
              },
              "required": [
                "type",
                "id"
              ]
            }
          ],
          "description": "インストーラーのダウンロードソース（installer.source 相当）"
        },
        "install_steps": {
          "type": "array",
          "items": {
            "anyOf": [
              {
                "$ref": "#/$defs/CatalogActionDownload"
              },
              {
                "$ref": "#/$defs/CatalogActionExtract"
              },
              {
                "$ref": "#/$defs/CatalogActionExtractSfx"
              },
              {
                "$ref": "#/$defs/CatalogActionCopy"
              },
              {
                "$ref": "#/$defs/CatalogActionDelete"
              },
              {
                "$ref": "#/$defs/CatalogActionRun"
              },
              {
                "$ref": "#/$defs/CatalogActionRunAuoSetup"
              }
            ]
          },
          "description": "インストール手順（installer.install 相当）"
        },
        "uninstall_steps": {
          "type": "array",
          "items": {
            "anyOf": [
              {
                "$ref": "#/$defs/CatalogActionDownload"
              },
              {
                "$ref": "#/$defs/CatalogActionExtract"
              },
              {
                "$ref": "#/$defs/CatalogActionExtractSfx"
              },
              {
                "$ref": "#/$defs/CatalogActionCopy"
              },
              {
                "$ref": "#/$defs/CatalogActionDelete"
              },
              {
                "$ref": "#/$defs/CatalogActionRun"
              },
              {
                "$ref": "#/$defs/CatalogActionRunAuoSetup"
              }
            ]
          },
          "description": "アンインストール手順（installer.uninstall 相当）"
        }
      },
      "required": [
        "id",
        "name",
        "type",
        "author",
        "summary",
        "homepage",
        "description",
        "license",
        "download_source"
      ]
    },
    "Artifact": {
      "type": "object",
      "properties": {
        "enabled": {
          "type": "boolean",
          "description": "成果物の有効/無効（デフォルトは true）"
        },
        "source": {
          "type": "string",
          "description": "成果物のパス"
        },
        "destination": {
          "type": "string",
          "description": "AviUtl2 の data 配下での配置先"
        },
        "build": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            {
              "$ref": "#/$defs/BuildGroupRef"
            }
          ],
          "description": "ビルドコマンド"
        },
        "placement_method": {
          "$ref": "#/$defs/PlacementMethod",
          "description": "配置方法（symlink / copy）"
        },
        "profiles": {
          "$ref": "#/$defs/RecordArtifactProfile",
          "description": "プロファイルごとの設定"
        }
      },
      "required": [
        "destination"
      ]
    },
    "TemplateCatalogLicense": {
      "type": "object",
      "properties": {
        "type": {
          "anyOf": [
            {
              "type": "string",
              "const": "MIT"
            },
            {
              "type": "string",
              "const": "Apache-2.0"
            },
            {
              "type": "string",
              "const": "BSD-2-Clause"
            },
            {
              "type": "string",
              "const": "BSD-3-Clause"
            }
          ],
          "description": "ライセンスの種類"
        },
        "template": {
          "type": "boolean",
          "const": true,
          "description": "テンプレートを使用するかどうか"
        },
        "author": {
          "type": "string",
          "description": "著作者"
        },
        "year": {
          "type": "string",
          "description": "年"
        }
      },
      "required": [
        "type",
        "template",
        "author",
        "year"
      ]
    },
    "CustomCatalogLicense": {
      "type": "object",
      "properties": {
        "type": {
          "anyOf": [
            {
              "type": "string",
              "const": "mit"
            },
            {
              "type": "string",
              "const": "apache-2.0"
            },
            {
              "type": "string",
              "const": "bsd-2-clause"
            },
            {
              "type": "string",
              "const": "bsd-3-clause"
            }
          ],
          "description": "ライセンスの種類"
        },
        "template": {
          "type": "boolean",
          "const": false,
          "description": "テンプレートを使用するかどうか"
        },
        "text": {
          "type": "string",
          "description": "ライセンスの全文"
        }
      },
      "required": [
        "type",
        "template",
        "text"
      ]
    },
    "CC0License": {
      "type": "object",
      "properties": {
        "type": {
          "type": "string",
          "const": "cc0",
          "description": "ライセンスの種類"
        }
      },
      "required": [
        "type"
      ]
    },
    "UnknownCatalogLicense": {
      "type": "object",
      "properties": {
        "type": {
          "type": "string",
          "const": "unknown",
          "description": "ライセンスの種類"
        }
      },
      "required": [
        "type"
      ]
    },
    "CatalogActionDownload": {
      "type": "object",
      "properties": {
        "action": {
          "type": "string",
          "const": "download"
        }
      },
      "required": [
        "action"
      ]
    },
    "CatalogActionExtract": {
      "type": "object",
      "properties": {
        "action": {
          "type": "string",
          "const": "extract"
        }
      },
      "required": [
        "action"
      ]
    },
    "CatalogActionExtractSfx": {
      "type": "object",
      "properties": {
        "action": {
          "type": "string",
          "const": "extract_sfx"
        }
      },
      "required": [
        "action"
      ]
    },
    "CatalogActionCopy": {
      "type": "object",
      "properties": {
        "action": {
          "type": "string",
          "const": "copy"
        },
        "from": {
          "type": "string"
        },
        "to": {
          "type": "string"
        }
      },
      "required": [
        "action",
        "from",
        "to"
      ]
    },
    "CatalogActionDelete": {
      "type": "object",
      "properties": {
        "action": {
          "type": "string",
          "const": "delete"
        },
        "path": {
          "type": "string"
        }
      },
      "required": [
        "action",
        "path"
      ]
    },
    "CatalogActionRun": {
      "type": "object",
      "properties": {
        "action": {
          "type": "string",
          "const": "run"
        },
        "path": {
          "type": "string"
        },
        "args": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "elevate": {
          "type": "boolean"
        }
      },
      "required": [
        "action",
        "path",
        "args"
      ]
    },
    "CatalogActionRunAuoSetup": {
      "type": "object",
      "properties": {
        "action": {
          "type": "string",
          "const": "run_auo_setup"
        },
        "path": {
          "type": "string"
        }
      },
      "required": [
        "action",
        "path"
      ]
    },
    "PlacementMethod": {
      "type": "string",
      "enum": [
        "symlink",
        "copy"
      ]
    },
    "RecordArtifactProfile": {
      "type": "object",
      "properties": {},
      "additionalProperties": {
        "$ref": "#/$defs/ArtifactProfile"
      }
    },
    "ArtifactProfile": {
      "type": "object",
      "properties": {
        "enabled": {
          "type": "boolean",
          "description": "成果物の有効/無効（デフォルトは true）"
        },
        "source": {
          "type": "string",
          "description": "成果物のパス"
        },
        "build": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            {
              "$ref": "#/$defs/BuildGroupRef"
            }
          ],
          "description": "ビルドコマンド"
        }
      }
    }
  }
}