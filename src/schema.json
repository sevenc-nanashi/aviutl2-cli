{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "aviutl2.config.schema.json",
  "type": "object",
  "properties": {
    "project": {
      "$ref": "#/$defs/Project",
      "description": "プロジェクト設定"
    },
    "artifacts": {
      "$ref": "#/$defs/RecordArtifact",
      "description": "成果物の定義"
    },
    "development": {
      "$ref": "#/$defs/Development",
      "description": "開発用の設定"
    },
    "preview": {
      "$ref": "#/$defs/Preview",
      "description": "プレビュー用の設定"
    },
    "release": {
      "$ref": "#/$defs/Release",
      "description": "リリース用の設定"
    }
  },
  "required": [
    "project",
    "artifacts"
  ],
  "$defs": {
    "Project": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "description": "プロジェクト名"
        },
        "version": {
          "type": "string",
          "description": "バージョン"
        }
      },
      "required": [
        "name",
        "version"
      ]
    },
    "RecordArtifact": {
      "type": "object",
      "properties": {},
      "additionalProperties": {
        "$ref": "#/$defs/Artifact"
      }
    },
    "Development": {
      "type": "object",
      "properties": {
        "aviutl2_version": {
          "type": "string",
          "description": "AviUtl2 のバージョン"
        },
        "install_dir": {
          "type": "string",
          "description": "AviUtl2 のインストール先"
        },
        "profile": {
          "type": "string",
          "description": "使うプロファイル名（デフォルトは debug）"
        },
        "prebuild": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          ],
          "description": "事前ビルドコマンド"
        },
        "postbuild": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          ],
          "description": "事後ビルドコマンド"
        }
      },
      "required": [
        "aviutl2_version"
      ]
    },
    "Preview": {
      "type": "object",
      "properties": {
        "aviutl2_version": {
          "type": "string",
          "description": "AviUtl2 のバージョン（省略時は development.aviutl2_version）"
        },
        "install_dir": {
          "type": "string",
          "description": "AviUtl2 のインストール先"
        },
        "profile": {
          "type": "string",
          "description": "使うプロファイル名（デフォルトは release）"
        },
        "include": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "含める成果物のリスト（省略時は release.include を使用）"
        },
        "prebuild": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          ],
          "description": "事前ビルドコマンド"
        },
        "postbuild": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          ],
          "description": "事後ビルドコマンド"
        }
      }
    },
    "Release": {
      "type": "object",
      "properties": {
        "output_dir": {
          "type": "string",
          "description": "出力ディレクトリ"
        },
        "package_template": {
          "type": "string",
          "description": "package.txt のテンプレート"
        },
        "zip_name": {
          "type": "string",
          "description": "zip の名前（`.au2pkg.zip` は自動付与）"
        },
        "profile": {
          "type": "string",
          "description": "使うプロファイル名（デフォルトは release）"
        },
        "include": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "含める成果物のリスト（省略時はすべて含める）"
        },
        "prebuild": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          ],
          "description": "事前ビルドコマンド"
        },
        "postbuild": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          ],
          "description": "事後ビルドコマンド"
        }
      }
    },
    "Artifact": {
      "type": "object",
      "properties": {
        "enabled": {
          "type": "boolean",
          "description": "成果物の有効/無効（デフォルトは true）"
        },
        "source": {
          "type": "string",
          "description": "成果物のパス"
        },
        "destination": {
          "type": "string",
          "description": "AviUtl2 の data 配下での配置先"
        },
        "build": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          ],
          "description": "ビルドコマンド"
        },
        "placement_method": {
          "$ref": "#/$defs/PlacementMethod",
          "description": "配置方法（symlink / copy）"
        },
        "profiles": {
          "$ref": "#/$defs/RecordArtifactProfile",
          "description": "プロファイルごとの設定"
        }
      },
      "required": [
        "destination"
      ]
    },
    "PlacementMethod": {
      "type": "string",
      "enum": [
        "symlink",
        "copy"
      ]
    },
    "RecordArtifactProfile": {
      "type": "object",
      "properties": {},
      "additionalProperties": {
        "$ref": "#/$defs/ArtifactProfile"
      }
    },
    "ArtifactProfile": {
      "type": "object",
      "properties": {
        "enabled": {
          "type": "boolean",
          "description": "成果物の有効/無効（デフォルトは true）"
        },
        "source": {
          "type": "string",
          "description": "成果物のパス"
        },
        "build": {
          "anyOf": [
            {
              "type": "string"
            },
            {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          ],
          "description": "ビルドコマンド"
        }
      }
    }
  }
}